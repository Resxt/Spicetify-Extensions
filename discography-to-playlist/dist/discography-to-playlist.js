!async function(){for(;!Spicetify.React||!Spicetify.ReactDOM;)await new Promise(t=>setTimeout(t,10));var t;t=async function(){for(;null==Spicetify||!Spicetify.showNotification;)await new Promise(t=>setTimeout(t,100));new Spicetify.ContextMenu.Item("Create playlist from discography",i,t=>Spicetify.URI.isArtist(t[0]),"playlist").register()},(async()=>{await t()})();async function r(i,t){var a,s=new Map;let e=`https://api.spotify.com/v1/artists/${i}/albums?include_groups=${t}&limit=50`;do{o=e;var o=await Spicetify.CosmosAsync.get(o);e=o.next;for(const n of o.items)if(void 0===n.artists.find(t=>"0LyfQWJT6nXafLPZqxe9Of"==t.id)){a=n.id;for(const r of(await Spicetify.CosmosAsync.get(`https://api.spotify.com/v1/albums/${a}/tracks?limit=50`)).items)void 0===r.artists.find(t=>t.id==i)||s.has(r.name)||s.set(r.name,r.uri)}}while(null!==e&&void 0!==e);return Promise.all(s.values())}async function i(t){var i,a,t=Spicetify.URI.fromString(t[0]).id,s=await Spicetify.CosmosAsync.get("https://api.spotify.com/v1/artists/"+t),e={name:"Discography of "+s.name,description:"Playlist with the entire discography of "+s.name+". Created with discography-to-playlist"};Spicetify.showNotification("Creating your playlist..",!1,5e3);i=e,n=await(await Spicetify.Platform.UserAPI.getUser()).username;const o=await Spicetify.CosmosAsync.post(`https://api.spotify.com/v1/users/${n}/playlists`,i);a=o.id,await!function(s,e="image/jpeg"){return new Promise((a,i)=>{var t=new Image;t.crossOrigin="Anonymous",t.onload=function(){var t=document.createElement("canvas"),i=t.getContext("2d"),i=(t.height=this.naturalHeight,t.width=this.naturalWidth,null!=i&&i.drawImage(this,0,0),t.toDataURL(e));a(i)},t.onerror=t=>{i(new Error("Failed to load image."+t))},t.src=s})}(s.images[0].url).then(async t=>{await Spicetify.CosmosAsync.put(`https://api.spotify.com/v1/playlists/${a}/images`,t.split("base64,")[1])});var n=await r(t,"album,single,appears_on,compilation");!function(i,a){var s=[];for(let t=0;t<i.length;t+=a)s.push(i.slice(t,t+a));return s}(n,100).forEach(async t=>{await Spicetify.CosmosAsync.post(`https://api.spotify.com/v1/playlists/${o.id}/tracks`,{uris:t})}),Spicetify.showNotification("Playlist "+e.name+" <br>successfully created with "+n.length+" tracks",!1,5e3)}}();